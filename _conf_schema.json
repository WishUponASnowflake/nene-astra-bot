{
  "dashscope_config": {
    "description": "阿里云 Dashscope 配置 (API Key 请设置在环境变量 DASHSCOPE_API_KEY 中)",
    "type": "object",
    "items": {
      "model_name": {
        "description": "模型名称",
        "type": "string",
        "default": "multimodal-embedding-v1",
        "hint": "要使用的多模态 Embedding 模型。通常保持默认即可。"
      }
    }
  },
  "admins_id": {
    "description": "插件管理员 ID 列表",
    "type": "list",
    "default": [],
    "hint": "在此处添加有权使用管理命令（如 llm_mute/llm_enable）的用户 ID。一行一个ID。"
  },
  "at_message_window": {
    "description": "被 @ 后等待后续消息的窗口时间（秒）",
    "type": "int",
    "default": 15,
    "hint": "当用户 @ 机器人时，机器人会等待这么长时间来收集用户的连续消息，然后一起处理。设置为 0 则禁用此功能。"
  },
  "at_message_prompt": {
    "description": "进入等待后续消息状态时对用户的提示",
    "type": "string",
    "default": "我在，请讲。在 {timeout} 秒内我会一并收听您的后续消息...",
    "hint": "这条消息会在用户 @ 机器人时发送，以提示用户可以连续发言。您可以使用 `{timeout}` 作为占位符来显示等待时间。"
  },
  "message_queue_size": {
    "description": "最近消息队列长度",
    "type": "int",
    "default": 10,
    "hint": "在处理消息时，附加的最近聊天记录数量，用于帮助模型理解上下文。建议设置在 5 到 20 之间。"
  },
  "reply_possibility": {
    "description": "备用触发概率 (0.0 至 1.0)",
    "type": "float",
    "default": 0.1,
    "hint": "仅在未配置“判断模型”时生效。设置一个 0 到 1 之间的小数，代表在非 @ 情况下随机触发回复的概率。"
  },
  "main_llm_provider": {
    "description": "最终回复使用的大语言模型配置",
    "type": "object",
    "items": {
      "provider_id": {
        "description": "服务提供商 ID",
        "type": "string",
        "hint": "请选择一个用于生成最终回复的大语言模型。",
        "_special": "select_provider"
      },
      "persona_prompt": {
        "description": "人格 Prompt (System Prompt)",
        "type": "text",
        "default": "你是一个友好、乐于助人的群聊助手。",
        "hint": "在这里输入你希望大模型扮演的人格或遵循的规则，它将作为 System Prompt 发送给模型。"
      }
    }
  },
  "judgement_model": {
    "description": "用于判断是否主动回复的小模型配置",
    "type": "object",
    "items": {
      "provider_id": {
        "description": "服务提供商 ID",
        "type": "string",
        "hint": "请选择一个轻量、快速的模型用作回复意愿判断。该模型需要根据对话判断回复的必要性，并给出一个0到1之间的概率值。",
        "_special": "select_provider"
      },
      "judgement_prompt": {
        "description": "判断模型的 Prompt",
        "type": "text",
        "default": "你是一个群聊中 AI 助手的回复决策模型。你的任务是分析以下聊天记录和最新消息，判断 AI 助手进行回复的“必要性”和“趣味性”，并决定回复方式。你的名字叫'宁宁'。\n\n--- 最近的聊天记录 ---\n{message_queue}\n\n--- 最新消息 ---\n{message_text}\n\n--- 回复标准 ---\n1.  **必要性判断**：给出一个 0.0 到 1.0 之间的概率分数。\n    -   当最新消息明显是对话题的延续，或者直接提到了你（宁宁），或者向你提问时，概率应为 1.0。\n    -   话题轻松有趣、适合闲聊，概率可以高一些 (0.6-0.8)。\n    -   话题与 AI、代码等相关，概率较高 (0.5-0.7)。\n    -   如果大家在讨论一个你完全不了解的私人话题，或者最新消息明显是用户间的对话（例如 @其他人），请保持安静，概率为 0.0。\n    -   无意义的闲聊或表情符号，概率应接近 0.0。\n2.  **回复方式判断**：\n    -   如果消息是对话题的延续或开放性陈述，使用 'direct' (直接回复)。\n    -   如果消息是明确的问题或为了避免误解，使用 'quote' (引用回复)。\n\n你的回答必须是一个严格的 JSON 对象，格式如下：\n{{\"probability\": <概率值>, \"reply_style\": \"<direct 或 quote>\"}}\n\n根据以上标准，你的决策是？",
        "hint": "这是发送给判断模型的指令。您可以使用 `{message_queue}` 和 `{message_text}` 作为占位符。"
      }
    }
  },
  "rag_decision_prompt": {
    "description": "RAG决策模型的Prompt",
    "type": "text",
    "default": "你是一个智能助手，负责分析对话并决定是否需要查找历史资料（RAG）来更好地回答问题。请分析以下最近的对话记录和当前用户消息。你的任务是：1. 判断是否有必要查找历史资料。如果当前对话主题明确、问题简单，或只是闲聊，则不需要。如果用户提到了过去的事情、不明确的代称，或提出了需要背景知识的复杂问题，则需要查找。2. 如果需要查找，请提炼出一个简洁、精确的关键词用于搜索。你的回答必须是一个严格的 JSON 对象，格式如下：{{\"rag_needed\": <true 或 false>, \"keyword\": \"<关键词>\"}}。例如：{{\"rag_needed\": true, \"keyword\": \"上次讨论的AI项目\"}} 或 {{\"rag_needed\": false, \"keyword\": \"\"}}。以下是对话内容：\n\n--- 最近对话 ---\n{message_queue}\n--- 当前消息 ---\n{current_message}\n\n你的决策是？",
    "hint": "用于指示小模型判断是否需要RAG并提取关键词。可使用 {message_queue} 和 {current_message} 占位符。"
  },
  "max_local_images": {
    "description": "本地存储图片的数量上限",
    "type": "int",
    "default": 50,
    "hint": "插件会在本地保存近期图片用于搜索结果展示。为防止占用过多硬盘，这里可以设置一个上限，超过该数量将自动删除最旧的图片。"
  },
  "top_k_text_results": {
    "description": "使用 /rag_search 命令时，返回最相关的文本结果的数量。",
    "type": "int",
    "default": 5,
    "hint": "建议设置在 3 到 10 之间。"
  },
  "top_j_image_results": {
    "description": "使用 /rag_search 命令时，返回最相关的图片结果的数量。",
    "type": "int",
    "default": 3,
    "hint": "建议设置在 1 到 5 之间。"
  }
}